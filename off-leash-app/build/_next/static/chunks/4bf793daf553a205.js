(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,7105,(e,a,t)=>{a.exports=e.r(16101)},51983,e=>{e.v({badges:"analyze-module__pfTzqa__badges",buttonRow:"analyze-module__pfTzqa__buttonRow",categoryBlock:"analyze-module__pfTzqa__categoryBlock",categoryHeader:"analyze-module__pfTzqa__categoryHeader",categoryTitle:"analyze-module__pfTzqa__categoryTitle",current:"analyze-module__pfTzqa__current",dataList:"analyze-module__pfTzqa__dataList",fieldGrid:"analyze-module__pfTzqa__fieldGrid",formCard:"analyze-module__pfTzqa__formCard",formHeader:"analyze-module__pfTzqa__formHeader",inlineNote:"analyze-module__pfTzqa__inlineNote",input:"analyze-module__pfTzqa__input",inputShell:"analyze-module__pfTzqa__inputShell",kicker:"analyze-module__pfTzqa__kicker",kpiCard:"analyze-module__pfTzqa__kpiCard",kpiGrid:"analyze-module__pfTzqa__kpiGrid",kpiHint:"analyze-module__pfTzqa__kpiHint",kpiLabel:"analyze-module__pfTzqa__kpiLabel",kpiValue:"analyze-module__pfTzqa__kpiValue",layout:"analyze-module__pfTzqa__layout",leftColumn:"analyze-module__pfTzqa__leftColumn",miniTable:"analyze-module__pfTzqa__miniTable",page:"analyze-module__pfTzqa__page",pillRow:"analyze-module__pfTzqa__pillRow",prefix:"analyze-module__pfTzqa__prefix",qtyInput:"analyze-module__pfTzqa__qtyInput",rehab:"analyze-module__pfTzqa__rehab",rehabSection:"analyze-module__pfTzqa__rehabSection",resultsCard:"analyze-module__pfTzqa__resultsCard",rightColumn:"analyze-module__pfTzqa__rightColumn",section:"analyze-module__pfTzqa__section",stabilized:"analyze-module__pfTzqa__stabilized",subgrid:"analyze-module__pfTzqa__subgrid",suffix:"analyze-module__pfTzqa__suffix",summaryCard:"analyze-module__pfTzqa__summaryCard",summaryHeader:"analyze-module__pfTzqa__summaryHeader",switch:"analyze-module__pfTzqa__switch",table:"analyze-module__pfTzqa__table",timelineBar:"analyze-module__pfTzqa__timelineBar",timelineMuted:"analyze-module__pfTzqa__timelineMuted",timelineSegment:"analyze-module__pfTzqa__timelineSegment",toggleButton:"analyze-module__pfTzqa__toggleButton",toggleButtonActive:"analyze-module__pfTzqa__toggleButtonActive",toggleButtonDisabled:"analyze-module__pfTzqa__toggleButtonDisabled"})},86493,e=>{"use strict";let a;var t,n,r=e.i(52480),l=e.i(76100),i=e.i(7105),s=((t={}).BUY_HOLD="BUY_HOLD",t.BRRRR="BRRRR",t.FLIP="FLIP",t),c=((n={}).RENTAL="RENTAL",n.FLIP="FLIP",n.RETAIL="RETAIL",n);function o(e){let a=e.modelCurrentVsFuture?Math.max(e.monthsUntilTenantLeaves,0):0,t=e.modelCurrentVsFuture&&e.isOccupied,n=e.rehabPlanned&&e.rehabLengthMonths>0,r=t||e.modelCurrentVsFuture&&"AFTER_TENANT"===e.rehabTiming,l=n?r?a+1:1:a+1,i=n?l+e.rehabLengthMonths-1:a;return{tenantMonths:a,rehabStartMonth:l,rehabEndMonth:i,stabilizedMonth:n?i+1:a+1,refinanceMonth:i+1}}function d({principal:e,annualRatePercent:a,termMonths:t}){let n=a/100/12,r=function(e,a,t,n=0,r=0){if(a<=0)throw Error("numberOfPayments must be greater than zero");if(0===e)return Math.abs((t+n)/a);let l=Math.pow(1+e,a);return Math.abs(e*(t*l+n)/((1+e*r)*(l-1)))}(n,t,e),l=e,i=[];for(let e=1;e<=t;e++){let a=l*n,t=r-a;l=Math.max(l-t,0),i.push({month:e,payment:r,principal:t,interest:a,balance:l})}return{payment:r,schedule:i}}function h(e,a={}){let t=a.months??12,n=a.currentGrowth??(()=>1),r=a.futureGrowth??(()=>1),l=o(e),i=[];for(let a=1;a<=t;a++){let t="STABILIZED",s=e.targetMonthlyRent*r(a);e.modelCurrentVsFuture&&a<=l.tenantMonths?(t="CURRENT",s=e.isOccupied?e.currentMonthlyRent*n(a):0):e.rehabPlanned&&l.rehabStartMonth>0&&a>=l.rehabStartMonth&&a<=l.rehabEndMonth?(t="REHAB",s=0):!1===e.modelCurrentVsFuture&&1===a&&(t="STABILIZED",s=e.targetMonthlyRent),i.push({month:a,phase:t,rent:s})}let s=i.reduce((e,a)=>e+a.rent,0),c=i.filter(e=>0===e.rent).length;return{schedule:i,phases:l,totalRent:s,zeroMonths:c}}function u(e,a){let t=o(e),n=Math.pow(1+e.annualAppreciationPercent/100,1/12)-1,r=e.asIsValue??e.purchasePrice,l=[];for(let i=1;i<=a;i++){let a;if(e.rehabPlanned&&t.rehabEndMonth>0)if(i<=t.rehabEndMonth)a=r*Math.pow(1+n,i);else if(i===t.rehabEndMonth+1)a=e.arv;else{let r=i-(t.rehabEndMonth+1);a=e.arv*Math.pow(1+n,r)}else a=r*Math.pow(1+n,i);l.push({month:i,value:a})}return{values:l,monthlyAppreciationRate:n}}let m=e=>e/100,p=e=>e/100,f=[{id:"flooring-lvp",label:"LVP Flooring (per sq ft)",category:"Flooring",unitType:"PER_SQFT",rentalPrice:4.5,flipPrice:6.5,defaultQuantity:1e3},{id:"flooring-carpet",label:"Carpeting (per sq ft)",category:"Flooring",unitType:"PER_SQFT",rentalPrice:3,flipPrice:4.5,defaultQuantity:1e3},{id:"flooring-bath-tile",label:"Tile for Bathroom Floor",category:"Flooring",unitType:"PER_BATH",rentalPrice:800,flipPrice:1200},{id:"kitchen-cabinets",label:"Kitchen Cabinets",category:"Kitchen",unitType:"PER_KITCHEN",rentalPrice:5e3,flipPrice:8e3},{id:"kitchen-countertops",label:"Kitchen Countertops",category:"Kitchen",unitType:"PER_KITCHEN",rentalPrice:3e3,flipPrice:5e3},{id:"kitchen-appliances",label:"Kitchen Appliance Package",category:"Kitchen",unitType:"PER_SET",rentalPrice:2500,flipPrice:4e3},{id:"kitchen-sink",label:"Kitchen Sink & Faucet",category:"Kitchen",unitType:"PER_UNIT",rentalPrice:400,flipPrice:700},{id:"bath-full-reno",label:"Full Bathroom Renovation",category:"Bathrooms",unitType:"PER_BATH",rentalPrice:4500,flipPrice:7500},{id:"bath-vanity",label:"New Vanity with Sink",category:"Bathrooms",unitType:"PER_UNIT",rentalPrice:600,flipPrice:1200},{id:"bath-toilet",label:"New Toilet",category:"Bathrooms",unitType:"PER_UNIT",rentalPrice:300,flipPrice:500},{id:"bath-mirror-light",label:"Bathroom Mirror & Light",category:"Bathrooms",unitType:"PER_SET",rentalPrice:200,flipPrice:400},{id:"general-interior-paint",label:"Interior Paint (per sq ft)",category:"General",unitType:"PER_SQFT",rentalPrice:1.5,flipPrice:2.5,defaultQuantity:1e3},{id:"general-drywall-repair",label:"Drywall Repair (per sq ft)",category:"General",unitType:"PER_SQFT",rentalPrice:.5,flipPrice:.8,defaultQuantity:1e3},{id:"general-wall-prep",label:"Wall Prep & Patching (per sq ft)",category:"General",unitType:"PER_SQFT",rentalPrice:.3,flipPrice:.5,defaultQuantity:1e3},{id:"general-interior-doors",label:"New Interior Doors",category:"General",unitType:"PER_DOOR",rentalPrice:250,flipPrice:350,defaultQuantity:6},{id:"general-door-knobs",label:"Door Knobs and Hardware",category:"General",unitType:"PER_SET",rentalPrice:35,flipPrice:65,defaultQuantity:6},{id:"general-exterior-doors",label:"New Exterior Doors",category:"General",unitType:"PER_DOOR",rentalPrice:500,flipPrice:800,defaultQuantity:2},{id:"general-windows",label:"New Windows",category:"General",unitType:"PER_WINDOW",rentalPrice:450,flipPrice:650,defaultQuantity:10},{id:"general-blinds",label:"Window Blinds",category:"General",unitType:"PER_WINDOW",rentalPrice:50,flipPrice:80,defaultQuantity:10},{id:"general-smoke-co",label:"Smoke/CO Detectors",category:"General",unitType:"PER_UNIT",rentalPrice:35,flipPrice:35,defaultQuantity:4},{id:"infra-exterior-paint",label:"Exterior Paint",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:4e3,flipPrice:6e3},{id:"infra-roof",label:"New Roof",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:8e3,flipPrice:1e4},{id:"infra-siding",label:"New Siding/Fascia",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:3500,flipPrice:5e3},{id:"infra-electrical",label:"Electrical Update",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:4e3,flipPrice:6e3},{id:"infra-plumbing",label:"Plumbing Update",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:3500,flipPrice:5e3},{id:"infra-water-heater",label:"Water Heater",category:"Infrastructure",unitType:"PER_UNIT",rentalPrice:1200,flipPrice:1800},{id:"infra-ac",label:"New AC Unit",category:"Infrastructure",unitType:"PER_UNIT",rentalPrice:5e3,flipPrice:6500},{id:"infra-furnace",label:"New Furnace",category:"Infrastructure",unitType:"PER_UNIT",rentalPrice:4500,flipPrice:5500},{id:"infra-landscaping",label:"Landscaping",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:2e3,flipPrice:3500},{id:"infra-concrete",label:"Concrete/Porch Work",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:2500,flipPrice:4e3},{id:"infra-waterproofing",label:"Basement Waterproofing",category:"Infrastructure",unitType:"PER_PROJECT",rentalPrice:3e3,flipPrice:4e3},{id:"contingency",label:"Contingency (per sq ft)",category:"Contingency",unitType:"PER_SQFT",rentalPrice:2,flipPrice:3,defaultQuantity:1e3},{id:"custom-1",label:"Custom Item 1",category:"Contingency",unitType:"PER_CUSTOM",rentalPrice:0,flipPrice:0}];function g(e,a){if("RENTAL"===a)return e.rentalPrice;if("FLIP"===a)return e.flipPrice;let t=e.retailMultiplier??1.5;return(e.flipPrice||e.rentalPrice)*t}let b=(e.i(18281).default.env.NEXT_PUBLIC_API_BASE_URL??"").replace(/\/$/,"");async function x(e,a){let t=await fetch(e,{...a,headers:{"Content-Type":"application/json",...a?.headers??{}},cache:"no-store"});if(!t.ok)throw Error(`Request failed: ${t.status}`);return t.json()}async function y(e){let a=new URLSearchParams;e?.limit!==void 0&&a.set("limit",String(e.limit)),e?.offset!==void 0&&a.set("offset",String(e.offset)),e?.q&&a.set("q",e.q),e?.strategy&&a.set("strategy",e.strategy);let t=a.toString()?`?${a.toString()}`:"";return x(`${b}/api/analyses${t}`)}async function v(e,a,t){return x(`${b}/api/analyses`,{method:"POST",body:JSON.stringify({name:e,payload:a,strategy:t})})}async function j(e,a,t,n){return x(`${b}/api/analyses/${e}`,{method:"PUT",body:JSON.stringify({name:a,payload:t,strategy:n})})}async function P(e){return x(`${b}/api/analyses/${e}`)}async function R(e){await x(`${b}/api/analyses/${e}`,{method:"DELETE"})}let N="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),M=new Uint8Array(16),T=[];for(let e=0;e<256;++e)T.push((e+256).toString(16).slice(1));let C=function(e,t,n){if(N&&!t&&!e)return N();var r=e,l=n;let i=(r=r||{}).random??r.rng?.()??function(){if(!a){if("undefined"==typeof crypto||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");a=crypto.getRandomValues.bind(crypto)}return a(M)}();if(i.length<16)throw Error("Random bytes length must be >= 16");if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){if((l=l||0)<0||l+16>t.length)throw RangeError(`UUID byte range ${l}:${l+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[l+e]=i[e];return t}return function(e,a=0){return(T[e[a+0]]+T[e[a+1]]+T[e[a+2]]+T[e[a+3]]+"-"+T[e[a+4]]+T[e[a+5]]+"-"+T[e[a+6]]+T[e[a+7]]+"-"+T[e[a+8]]+T[e[a+9]]+"-"+T[e[a+10]]+T[e[a+11]]+T[e[a+12]]+T[e[a+13]]+T[e[a+14]]+T[e[a+15]]).toLowerCase()}(i)},_="offleash_scenarios_v1";function w(){try{let e=window.localStorage.getItem(_);if(!e)return[];let a=JSON.parse(e);if(!Array.isArray(a))return[];return a}catch{return[]}}function I(e){window.localStorage.setItem(_,JSON.stringify(e))}function E(e,a,t){let n=w(),r=new Date().toISOString(),l={id:t??C(),name:e.trim()||"Untitled scenario",savedAt:r,payload:a};return I(t?n.map(e=>e.id===t?l:e):[...n,l]),l}function A(e){return w().find(a=>a.id===e)}var L=e.i(51983);let S={purchasePrice:325e3,arv:36e4,asIsValue:325e3,targetMonthlyRent:2750,annualAppreciationPercent:3,monthsToSimulate:12,modelCurrentVsFuture:!0,isOccupied:!1,currentMonthlyRent:0,monthsUntilTenantLeaves:0,rehabPlanned:!1,rehabTiming:"IMMEDIATE",rehabLengthMonths:2,loan:{purchasePrice:325e3,downPaymentPercent:25,interestRateAnnualPercent:6.5,termYears:30,closingCostsPercent:2.5,lenderPointsPercent:1},operating:{taxesAnnual:4800,insuranceAnnual:1200,repairsPercent:5,capexPercent:5,managementPercent:8,vacancyPercent:5,otherMonthlyExpenses:150,utilitiesMonthly:0},strategy:s.BUY_HOLD,rehabClass:c.RENTAL,rehabSelections:f.map(e=>({itemId:e.id,quantity:e.defaultQuantity??0,enabled:!1})),includeRehabInCashRequired:!0,bridgeRate:9,bridgeLtvPercent:100,bridgePointsPercent:1,bridgeClosingCostsPercent:2,includeRehabInBridge:!1,refinanceLtvPercent:75,flipHoldMonths:2,sellingCostsPercent:2,agentFeePercent:5,marginalTaxRatePercent:25},z=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}),F=e=>Number.isFinite(e)?e:"";function q(){let e=(0,i.useSearchParams)(),a=(0,i.useRouter)(),[t,n]=(0,l.useState)(S),[b,x]=(0,l.useState)("My scenario"),[N,M]=(0,l.useState)(void 0),[T,C]=(0,l.useState)([]),[_,q]=(0,l.useState)(null),[k,$]=(0,l.useState)(!1),[D,H]=(0,l.useState)("idle"),[G,Q]=(0,l.useState)(!0),[Y,K]=(0,l.useState)(0),J=(0,l.useMemo)(()=>h({modelCurrentVsFuture:t.modelCurrentVsFuture,isOccupied:t.isOccupied,currentMonthlyRent:t.currentMonthlyRent,monthsUntilTenantLeaves:t.monthsUntilTenantLeaves,targetMonthlyRent:t.targetMonthlyRent,rehabPlanned:t.rehabPlanned,rehabTiming:t.rehabTiming,rehabLengthMonths:t.rehabLengthMonths,asIsValue:t.asIsValue},{months:t.monthsToSimulate}),[t]),W=J.phases,Z=W.rehabEndMonth?W.rehabEndMonth-W.rehabStartMonth+1:0,X=(0,l.useMemo)(()=>(function(e,a=c.RENTAL,t=f){let n=e.filter(e=>e.enabled??!0).map(e=>{let n=t.find(a=>a.id===e.itemId);if(!n)throw Error(`Unknown rehab item: ${e.itemId}`);let r="RETAIL"===a&&e.customRetailPrice?e.customRetailPrice:g(n,a),l=e.customUnitPrice??r,i=e.quantity??n.defaultQuantity??0;return{item:n,quantity:i,unitPrice:l,lineTotal:l*i}});return{total:n.reduce((e,a)=>e+a.lineTotal,0),lineItems:n}})(t.rehabSelections,t.rehabClass),[t.rehabClass,t.rehabSelections]),ee=e=>{n(a=>({...a,rehabSelections:a.rehabSelections.map(a=>{let t=f.find(e=>e.id===a.itemId),n=t?.defaultQuantity??0;return"defaults"===e?{...a,quantity:n,enabled:n>0}:{...a,quantity:0,enabled:!1}})}))},ea=(0,l.useMemo)(()=>(function(e){let a=e.purchasePrice*(1-m(e.loan.downPaymentPercent)),t=(e.loan.closingCostsPercent??0)*e.purchasePrice/100,n=(e.loan.lenderPointsPercent??0)*a/100,r=e.purchasePrice-a+t+n,l={downPayment:e.purchasePrice-a,closingCosts:t,lenderPoints:n,rehab:e.rehabTotal},i=r+(e.rehabTotal??0),s=d({principal:a,annualRatePercent:e.loan.interestRateAnnualPercent,termMonths:12*e.loan.termYears}),c=h(e.rent,{months:e.months}),o=u({...e.rent,arv:e.arv,purchasePrice:e.purchasePrice,annualAppreciationPercent:e.annualAppreciationPercent},e.months),p=[];for(let a=0;a<e.months;a++){let t=a+1,n=c.schedule[a]?.rent??0,r=n*m(e.operating.vacancyPercent),l=n*m(e.operating.repairsPercent),i=n*m(e.operating.capexPercent),d=n*m(e.operating.managementPercent),h=e.operating.taxesAnnual/12,u=e.operating.insuranceAnnual/12,f=e.operating.utilitiesMonthly??0,g=e.operating.otherMonthlyExpenses??0,b=s.schedule[a]??s.schedule[s.schedule.length-1],x=n-(r+l+i+d+f+g+h+u)-b.payment,y=(p[a-1]?.cumulativeCashFlow??0)+x,v=o.values[a]?.value??e.purchasePrice,j=v-b.balance;p.push({month:t,rent:n,expenses:{vacancy:r,repairs:l,capex:i,management:d,taxes:h,insurance:u,utilities:f,other:g},mortgage:b,cashFlow:x,cumulativeCashFlow:y,propertyValue:v,equity:j})}let f=[],g=Math.ceil(e.months/12);for(let a=1;a<=g;a++){let t=(a-1)*12,n=p.slice(t,t+12);if(0===n.length)break;let r=n.reduce((e,a)=>e+a.rent,0)-n.reduce((e,a)=>e+a.expenses.vacancy+a.expenses.repairs+a.expenses.capex+a.expenses.management+a.expenses.taxes+a.expenses.insurance+a.expenses.utilities+a.expenses.other,0),l=n.reduce((e,a)=>e+a.mortgage.payment,0),s=n.reduce((e,a)=>e+a.mortgage.principal,0),c=Math.max(0,n[n.length-1]?.propertyValue-n[0]?.propertyValue||0),o=n.reduce((e,a)=>e+a.cashFlow,0),d=n[n.length-1]?.equity??0;f.push({year:a,noi:r,cashFlow:o,debtService:l,principalPaid:s,appreciation:c,endingEquity:d,cashOnCash:i?o/i:0,capRate:e.purchasePrice?r/e.purchasePrice:0,dscr:l?r/l:0})}let b={cashRequired:i,cashRequiredWithRehab:i,cashRequiredBreakdown:l,totalReturn:(p[p.length-1]?.cumulativeCashFlow??0)+(p[p.length-1]?.equity??0),dscr:f[0]?.dscr,coc:f[0]?.cashOnCash};return{monthly:p,annual:f,metrics:b}})({rent:{modelCurrentVsFuture:t.modelCurrentVsFuture,isOccupied:t.isOccupied,currentMonthlyRent:t.currentMonthlyRent,monthsUntilTenantLeaves:t.monthsUntilTenantLeaves,targetMonthlyRent:t.targetMonthlyRent,rehabPlanned:t.rehabPlanned,rehabTiming:t.rehabTiming,rehabLengthMonths:t.rehabLengthMonths,asIsValue:t.asIsValue},loan:{...t.loan,purchasePrice:t.purchasePrice},operating:t.operating,arv:t.arv,purchasePrice:t.purchasePrice,annualAppreciationPercent:t.annualAppreciationPercent,months:t.monthsToSimulate,rehabTotal:t.includeRehabInCashRequired?X.total:0}),[t,X.total]),et=(0,l.useMemo)(()=>(function(e){let a=h(e.rent,{months:e.months}),t=a.phases,n=t.refinanceMonth??t.stabilizedMonth??1,r=e.operating??{vacancyPercent:0,repairsPercent:0,capexPercent:0,managementPercent:0,taxesAnnual:0,insuranceAnnual:0,utilitiesMonthly:0,otherMonthlyExpenses:0},l=(e.purchasePrice+(e.bridge.includeRehabInBridge??!0?e.rehabTotal:0))*(e.bridge.ltvPercent??100)/100,i=(e.bridge.pointsPercent??0)*l/100,s=(e.bridge.closingCostsPercent??0)*e.purchasePrice/100,c=p(e.bridge.interestRateAnnualPercent)/12,o=u({...e.rent,arv:e.arv,purchasePrice:e.purchasePrice,annualAppreciationPercent:e.annualAppreciationPercent},e.months),m=0;for(let e=1;e<n;e++)m+=l*c;let f=(r.taxesAnnual/12+r.insuranceAnnual/12+(r.utilitiesMonthly??0)+(r.otherMonthlyExpenses??0))*Math.max(n-1,0),g=o.values.find(e=>e.month===n)?.value??e.arv,b=g*p(e.refinanceLtvPercent),x=l+m,y=Math.max(b-x,0),v=d({principal:b,annualRatePercent:e.longTermLoan.interestRateAnnualPercent,termMonths:12*e.longTermLoan.termYears}),j=[],P=0,R=0;for(let t=0;t<e.months;t++){let e=t+1,i=a.schedule[t]?.rent??0,s=i*p(r.vacancyPercent),d=i*p(r.repairsPercent),h=i*p(r.capexPercent),u=i*p(r.managementPercent),m=r.taxesAnnual/12,f=r.insuranceAnnual/12,b=r.utilitiesMonthly??0,x=r.otherMonthlyExpenses??0,y=e>=n?v.schedule[Math.min(e-n,v.schedule.length-1)]:{month:e,payment:l*c,principal:0,interest:l*c,balance:l},N=i-(s+d+h+u+m+f+b+x)-y.payment;P+=N,e>=n&&(R+=N);let M=o.values[t]?.value??g,T=M-y.balance;j.push({month:e,rent:i,expenses:{vacancy:s,repairs:d,capex:h,management:u,taxes:m,insurance:f,utilities:b,other:x},mortgage:y,cashFlow:N,cumulativeCashFlow:P,propertyValue:M,equity:T})}let N=[],M=Math.ceil(e.months/12);for(let e=1;e<=M;e++){let a=j.slice((e-1)*12,12*e);if(!a.length)break;let t=a.reduce((e,a)=>e+(a.rent-(a.expenses.vacancy+a.expenses.repairs+a.expenses.capex+a.expenses.management+a.expenses.utilities+a.expenses.other+a.expenses.taxes+a.expenses.insurance)),0),n=a.reduce((e,a)=>e+a.mortgage.payment,0),r=a.reduce((e,a)=>e+a.mortgage.principal,0),l=a.reduce((e,a)=>e+a.cashFlow,0),i=Math.max(0,a[a.length-1].propertyValue-a[0].propertyValue),s=a[a.length-1].equity;N.push({year:e,noi:t,cashFlow:l,debtService:n,principalPaid:r,appreciation:i,endingEquity:s,cashOnCash:0,capRate:0,dscr:n?t/n:0})}let T=s+i+e.rehabTotal,C=T+m+f,_=T?R/T:0;return{monthly:j,annual:N,metrics:{cashRequired:C,cashRequiredBreakdown:{downPayment:0,closingCosts:s,lenderPoints:i,rehab:e.rehabTotal,carrying:f+m},totalReturn:(j[j.length-1]?.equity??0)+(j[j.length-1]?.cumulativeCashFlow??0),dscr:N[0]?.dscr,coc:_},refinanceMonth:n,bridgeInterest:m,cashOut:y,valueAtRefi:g,refinanceAmount:b,payoffBridge:x,carryingCosts:f+m}})({rent:{modelCurrentVsFuture:t.modelCurrentVsFuture,isOccupied:t.isOccupied,currentMonthlyRent:t.currentMonthlyRent,monthsUntilTenantLeaves:t.monthsUntilTenantLeaves,targetMonthlyRent:t.targetMonthlyRent,rehabPlanned:t.rehabPlanned,rehabTiming:t.rehabTiming,rehabLengthMonths:t.rehabLengthMonths,asIsValue:t.asIsValue},operating:t.operating,longTermLoan:{...t.loan,purchasePrice:t.purchasePrice},bridge:{interestRateAnnualPercent:t.bridgeRate,pointsPercent:t.bridgePointsPercent,closingCostsPercent:t.bridgeClosingCostsPercent,ltvPercent:t.bridgeLtvPercent,includeRehabInBridge:t.includeRehabInBridge},refinanceLtvPercent:t.refinanceLtvPercent,purchasePrice:t.purchasePrice,arv:t.arv,rehabTotal:X.total,annualAppreciationPercent:t.annualAppreciationPercent,months:t.monthsToSimulate}),[t,X.total]),en=(0,l.useMemo)(()=>{var e;let a,n,r,l,i,s,c,d,h,u,m,p;return n=((a=o((e={rent:{modelCurrentVsFuture:t.modelCurrentVsFuture,isOccupied:t.isOccupied,currentMonthlyRent:t.currentMonthlyRent,monthsUntilTenantLeaves:t.monthsUntilTenantLeaves,targetMonthlyRent:t.targetMonthlyRent,rehabPlanned:t.rehabPlanned,rehabTiming:t.rehabTiming,rehabLengthMonths:t.rehabLengthMonths,asIsValue:t.asIsValue},purchasePrice:t.purchasePrice,arv:t.arv,rehabTotal:X.total,rehabMonths:t.rehabLengthMonths,holdMonths:t.flipHoldMonths,bridge:{interestRateAnnualPercent:t.bridgeRate,pointsPercent:t.bridgePointsPercent,closingCostsPercent:t.bridgeClosingCostsPercent,ltvPercent:t.bridgeLtvPercent,includeRehabInBridge:t.includeRehabInBridge},sellingCostsPercent:t.sellingCostsPercent,agentFeePercent:t.agentFeePercent,taxesMonthly:t.operating.taxesAnnual/12,insuranceMonthly:t.operating.insuranceAnnual/12,marginalTaxRatePercent:t.marginalTaxRatePercent}).rent??{modelCurrentVsFuture:!1,isOccupied:!1,currentMonthlyRent:0,monthsUntilTenantLeaves:0,targetMonthlyRent:0,rehabPlanned:!0,rehabTiming:"IMMEDIATE",rehabLengthMonths:e.rehabMonths,asIsValue:e.purchasePrice})).rehabEndMonth?a.rehabEndMonth-a.rehabStartMonth+1:e.rehabMonths)+e.holdMonths+a.tenantMonths,r=(e.purchasePrice+(e.bridge.includeRehabInBridge??!0?e.rehabTotal:0))*(e.bridge.ltvPercent??100)/100,l=(e.bridge.pointsPercent??0)*r/100,i=(e.bridge.closingCostsPercent??0)*e.purchasePrice/100,s=e.bridge.interestRateAnnualPercent/100/12,c=(e.taxesMonthly+e.insuranceMonthly)*n,d=r+l+i+r*s*n+c+e.arv*(e.agentFeePercent/100)+e.arv*(e.sellingCostsPercent/100),h=e.arv-d,u=(e.marginalTaxRatePercent??0)/100,m=h>0?h*u:0,p=h-m,{saleMonth:n,salePrice:e.arv,totalCosts:d,netProfit:h,roi:d?h/d:0,profitAfterTax:p,taxOnProfit:m,roiAfterTax:d?p/d:0}},[t,X.total]),er=(0,l.useMemo)(()=>{var e;let a,n,r,l,i,s,c,d,h,u,m,p,f,g;return n=((a=o((e={rent:{modelCurrentVsFuture:t.modelCurrentVsFuture,isOccupied:t.isOccupied,currentMonthlyRent:t.currentMonthlyRent,monthsUntilTenantLeaves:t.monthsUntilTenantLeaves,targetMonthlyRent:t.targetMonthlyRent,rehabPlanned:t.rehabPlanned,rehabTiming:t.rehabTiming,rehabLengthMonths:t.rehabLengthMonths,asIsValue:t.asIsValue},purchasePrice:t.purchasePrice,arv:t.arv,rehabTotal:X.total,rehabMonths:t.rehabLengthMonths,holdMonths:t.flipHoldMonths,bridge:{interestRateAnnualPercent:t.bridgeRate,pointsPercent:t.loan.lenderPointsPercent,closingCostsPercent:t.loan.closingCostsPercent},sellingCostsPercent:t.sellingCostsPercent,agentFeePercent:t.agentFeePercent,taxesMonthly:t.operating.taxesAnnual/12,insuranceMonthly:t.operating.insuranceAnnual/12,marginalTaxRatePercent:t.marginalTaxRatePercent}).rent??{modelCurrentVsFuture:!1,isOccupied:!1,currentMonthlyRent:0,monthsUntilTenantLeaves:0,targetMonthlyRent:0,rehabPlanned:!0,rehabTiming:"IMMEDIATE",rehabLengthMonths:e.rehabMonths,asIsValue:e.purchasePrice})).rehabEndMonth?a.rehabEndMonth-a.rehabStartMonth+1:e.rehabMonths)+e.holdMonths+a.tenantMonths,r=(e.purchasePrice+(e.bridge.includeRehabInBridge??!0?e.rehabTotal:0))*(e.bridge.ltvPercent??100)/100,l=(e.bridge.pointsPercent??0)*r/100,i=(e.bridge.closingCostsPercent??0)*e.purchasePrice/100,s=r*(e.bridge.interestRateAnnualPercent/100/12)*n,c=(e.taxesMonthly+e.insuranceMonthly)*n,d=e.arv*(e.agentFeePercent/100),u=r+l+i+s+c+d+(h=e.arv*(e.sellingCostsPercent/100)),m=e.arv-u,p=(e.marginalTaxRatePercent??0)/100,f=m>0?m*p:0,g=m-f,{monthsFinanced:n,bridgePrincipal:r,points:l,closing:i,interest:s,carrying:c,agentFee:d,sellingCosts:h,totalCosts:u,netProfit:m,roi:u?m/u:0,taxOnProfit:f,profitAfterTax:g,roiAfterTax:u?g/u:0,saleMonth:n,salePrice:e.arv}},[t,X.total]),el=ea.monthly[ea.monthly.length-1],ei=(e,a)=>{n(t=>({...t,[e]:a}))},es=async()=>{try{let{items:e,total:a}=await y({limit:50});C(e),K(a),H("idle")}catch(a){console.error(a),q("Unable to load saved scenarios; using device storage"),H("offline");let e=w().sort((e,a)=>e.savedAt<a.savedAt?1:-1).map(e=>({id:e.id,name:e.name,strategy:e.payload.strategy,payload:e.payload,createdAt:e.savedAt,updatedAt:e.savedAt}));C(e),K(e.length)}},ec=async()=>{try{H("saving");let e=N?await j(N,b,t,t.strategy):await v(b,t,t.strategy);M(e.id),x(e.name),es(),q("Scenario saved"),H("idle")}catch(a){console.error(a);let e=E(b,t,N);M(e.id),x(e.name),es(),q("Saved locally (offline)"),H("offline")}},eo=async e=>{if(e)try{let a=await P(e),t=`${a.name} (copy)`,r=await v(t,a.payload,a.strategy);M(r.id),x(r.name),n(a.payload),es(),q("Scenario duplicated")}catch(a){console.error(a);try{let a=A(e);if(!a)throw Error("Not found");let t=E(`${a.name} (copy)`,a.payload);M(t.id),x(t.name),n(a.payload),es(),q("Duplicated locally")}catch(e){console.error(e),q("Unable to duplicate scenario")}}},ed=async e=>{try{let a=await P(e);a&&(n(a.payload),M(a.id),x(a.name))}catch(t){console.error(t);let a=A(e);a?(n(a.payload),M(a.id),x(a.name),q("Loaded from device storage")):q("Unable to load scenario")}},eh=async e=>{try{await R(e),N===e&&M(void 0),es()}catch(a){console.error(a),I(w().filter(a=>a.id!==e)),N===e&&M(void 0),es(),q("Deleted locally")}},eu=async()=>{try{let e;await navigator.clipboard.writeText((e=encodeURIComponent(btoa(JSON.stringify(t))),`${window.location.origin}/analyze?s=${e}`)),q("Share link copied"),setTimeout(()=>q(null),2e3)}catch{q("Unable to copy")}};return(0,l.useEffect)(()=>{if(t.isOccupied&&t.modelCurrentVsFuture&&t.rehabPlanned&&"IMMEDIATE"===t.rehabTiming){n(e=>({...e,rehabTiming:"AFTER_TENANT"})),$(!0);return}t.isOccupied&&t.modelCurrentVsFuture&&t.rehabPlanned||$(!1),!t.isOccupied&&t.modelCurrentVsFuture&&t.rehabPlanned&&n(e=>({...e,rehabTiming:"IMMEDIATE"}))},[t.isOccupied,t.modelCurrentVsFuture,t.rehabPlanned,t.rehabTiming]),(0,l.useEffect)(()=>{es()},[]),(0,l.useEffect)(()=>{let e=()=>Q(navigator.onLine);return e(),window.addEventListener("online",e),window.addEventListener("offline",e),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",e)}},[]),(0,l.useEffect)(()=>{let t=e.get("s");if(t)try{let e=JSON.parse(atob(t));n({...S,...e,operating:{...S.operating,...e.operating},loan:{...S.loan,...e.loan}}),x("Shared scenario"),q("Loaded from share link");let r=new URL(window.location.href);r.searchParams.delete("s"),a.replace(r.toString())}catch{q("Invalid share link")}},[]),(0,r.jsxs)("div",{className:L.default.page,children:[(0,r.jsx)("div",{className:"section-title",children:(0,r.jsx)("h2",{children:"Analyzer"})}),(0,r.jsxs)("div",{className:L.default.layout,children:[(0,r.jsx)("div",{className:L.default.leftColumn,children:(0,r.jsxs)("div",{className:`${L.default.formCard} card`,children:[(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Scenario"}),(0,r.jsx)("div",{className:"pill-ghost",children:N?"Saved":"Unsaved"})]}),_?(0,r.jsx)("div",{className:"chip badge-accent",children:_}):null,(0,r.jsxs)("div",{className:L.default.statusRow,children:[(0,r.jsxs)("div",{className:"chip",children:["Sync: ","saving"===D?"Saving...":"offline"===D?"Offline (local only)":"Online"]}),(0,r.jsxs)("div",{className:"chip",children:["Connection: ",G?"Online":"Offline"]}),(0,r.jsxs)("div",{className:"chip",children:["Saved: ",Y]})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[(0,r.jsxs)("label",{className:"input-group",children:[(0,r.jsx)("div",{className:"input-label",children:"Scenario name"}),(0,r.jsx)("input",{className:"input",value:b,onChange:e=>x(e.target.value)})]}),(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)("button",{className:"btn btn-primary",type:"button",onClick:ec,children:"Save scenario"}),(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>eo(N??""),disabled:!N,children:"Save as copy"}),(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>n(S),children:"Reset"}),(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:eu,children:"Copy share link"})]})]}),T.length?(0,r.jsxs)("div",{className:L.default.subgrid,children:[(0,r.jsx)("div",{className:"pill-ghost",style:{width:"fit-content"},children:"My saved scenarios"}),(0,r.jsxs)("table",{className:L.default.miniTable,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Saved"}),(0,r.jsx)("th",{})]})}),(0,r.jsx)("tbody",{children:T.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.name}),(0,r.jsx)("td",{children:new Date(e.updatedAt??e.createdAt).toLocaleString()}),(0,r.jsxs)("td",{className:L.default.buttonRow,children:[(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>ed(e.id),children:"Load"}),(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>eo(e.id),children:"Duplicate"}),(0,r.jsx)("button",{className:"btn btn-ghost",type:"button",onClick:()=>eh(e.id),children:"Delete"})]})]},e.id))})]})]}):null]}),(0,r.jsx)("div",{className:L.default.buttonRow,style:{marginBottom:12},children:[s.BUY_HOLD,s.BRRRR,s.FLIP].map(e=>(0,r.jsx)(O,{label:e===s.BUY_HOLD?"Buy & Hold":e===s.BRRRR?"BRRRR":"Flip",active:t.strategy===e,onClick:()=>ei("strategy",e)},e))}),(0,r.jsxs)("header",{className:L.default.formHeader,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:L.default.kicker,children:"Rental Details"}),(0,r.jsx)("h3",{children:"Current vs future conditions"}),(0,r.jsx)("p",{className:"muted",children:"Capture a tenant-occupied phase, a rehab window, and a stabilized future rent without losing backward compatibility."})]}),(0,r.jsxs)("label",{className:L.default.switch,children:[(0,r.jsx)("input",{type:"checkbox",checked:t.modelCurrentVsFuture,onChange:e=>ei("modelCurrentVsFuture",e.target.checked)}),(0,r.jsx)("span",{children:"Model current vs future conditions"})]})]}),(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Property snapshot"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Strategy neutral"})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[(0,r.jsx)(B,{label:"Purchase price",value:F(t.purchasePrice),onChange:e=>ei("purchasePrice",e),prefix:"$",tooltip:"Contract price paid at closing."}),(0,r.jsx)(B,{label:"ARV",value:F(t.arv),onChange:e=>ei("arv",e),prefix:"$",tooltip:"After-repair value for stabilized condition."}),(0,r.jsx)(B,{label:"Annual appreciation %",value:F(t.annualAppreciationPercent),onChange:e=>ei("annualAppreciationPercent",e),suffix:"%",tooltip:"Assumed property value growth per year."}),(0,r.jsx)(B,{label:"As-is value (optional)",helper:"Defaults to purchase price if left blank",value:F(t.asIsValue),onChange:e=>ei("asIsValue",e),prefix:"$",tooltip:"Current market value before rehab/turnover."}),(0,r.jsx)(B,{label:"Target monthly rent after rehab / turnover",value:F(t.targetMonthlyRent),onChange:e=>ei("targetMonthlyRent",e),prefix:"$",tooltip:"Stabilized rent once rehab/turnover is complete."}),(0,r.jsx)(B,{label:"Months to simulate",helper:"Drives timeline preview, rent, and value tables.",value:F(t.monthsToSimulate),onChange:e=>ei("monthsToSimulate",Math.max(1,Math.round(e))),tooltip:"How far out to run the monthly/annual schedules."}),t.strategy!==s.BUY_HOLD?(0,r.jsx)(B,{label:"Bridge rate % (short-term)",value:F(t.bridgeRate),onChange:e=>ei("bridgeRate",e),suffix:"%"}):null,t.strategy===s.FLIP?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B,{label:"Flip hold months (post-rehab)",value:F(t.flipHoldMonths),onChange:e=>ei("flipHoldMonths",e)}),(0,r.jsx)(B,{label:"Seller costs % (flip)",value:F(t.sellingCostsPercent),onChange:e=>ei("sellingCostsPercent",e),suffix:"%"}),(0,r.jsx)(B,{label:"Agent fee % (flip)",value:F(t.agentFeePercent),onChange:e=>ei("agentFeePercent",e),suffix:"%"}),(0,r.jsx)(B,{label:"Marginal tax rate % (flip)",value:F(t.marginalTaxRatePercent),onChange:e=>ei("marginalTaxRatePercent",e),suffix:"%"})]}):null]})]}),t.modelCurrentVsFuture?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Occupancy"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Phase 1 • Current condition"})]}),(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)(O,{label:"Currently occupied",active:t.isOccupied,onClick:()=>ei("isOccupied",!0)}),(0,r.jsx)(O,{label:"Vacant",active:!t.isOccupied,onClick:()=>ei("isOccupied",!1)})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[t.isOccupied&&(0,r.jsx)(B,{label:"Current monthly rent",value:F(t.currentMonthlyRent),onChange:e=>ei("currentMonthlyRent",e),prefix:"$"}),(0,r.jsx)(B,{label:"Months until current tenant leaves",value:F(t.monthsUntilTenantLeaves),onChange:e=>ei("monthsUntilTenantLeaves",e),tooltip:"Enter 0 if vacant or tenant leaves immediately."})]})]}),(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Rehab timing relative to tenancy"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Phase 2 • Rehab"})]}),(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)(O,{label:"Rehab planned",active:t.rehabPlanned,onClick:()=>ei("rehabPlanned",!0)}),(0,r.jsx)(O,{label:"No rehab",active:!t.rehabPlanned,onClick:()=>ei("rehabPlanned",!1)})]}),t.rehabPlanned&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)(O,{label:"Immediately after purchase",active:"IMMEDIATE"===t.rehabTiming,disabled:t.isOccupied&&t.modelCurrentVsFuture,onClick:()=>ei("rehabTiming","IMMEDIATE")}),(0,r.jsx)(O,{label:"After current tenant leaves",active:"AFTER_TENANT"===t.rehabTiming,onClick:()=>ei("rehabTiming","AFTER_TENANT")})]}),t.isOccupied&&t.modelCurrentVsFuture?(0,r.jsx)("p",{className:"muted",children:"Occupied properties must rehab after the tenant leaves."}):null,k?(0,r.jsx)("div",{className:"chip badge-accent",children:"Rehab timing auto-set to after tenant move-out"}):null,(0,r.jsx)("div",{className:L.default.fieldGrid,children:(0,r.jsx)(B,{label:"Rehab length (months)",value:F(t.rehabLengthMonths),onChange:e=>ei("rehabLengthMonths",e),tooltip:"Duration of the rehab window."})})]})]})]}):(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Legacy mode"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Matches current experience"})]}),(0,r.jsx)("p",{className:"muted",children:"Timeline controls are hidden. Property is treated as stabilized from the first rentable month. Rehab follows existing timing rules (immediate)."})]}),(t.strategy===s.BRRRR||t.strategy===s.FLIP)&&(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Short-term financing"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Bridge / rehab phase"})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[(0,r.jsx)(B,{label:"Bridge interest rate % (annual)",value:F(t.bridgeRate),onChange:e=>ei("bridgeRate",e),suffix:"%",tooltip:"Annual rate on the short-term bridge loan."}),(0,r.jsx)(B,{label:"Bridge LTV %",value:F(t.bridgeLtvPercent),onChange:e=>ei("bridgeLtvPercent",e),suffix:"%",tooltip:"Bridge loan as % of purchase (and rehab if included)."}),(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)(O,{label:"Include rehab in bridge",active:t.includeRehabInBridge,onClick:()=>ei("includeRehabInBridge",!0)}),(0,r.jsx)(O,{label:"Exclude rehab from bridge",active:!t.includeRehabInBridge,onClick:()=>ei("includeRehabInBridge",!1)})]}),(0,r.jsx)(B,{label:"Bridge points %",value:F(t.bridgePointsPercent),onChange:e=>ei("bridgePointsPercent",e),suffix:"%",tooltip:"Points charged on the bridge principal."}),(0,r.jsx)(B,{label:"Bridge closing costs % of purchase",value:F(t.bridgeClosingCostsPercent),onChange:e=>ei("bridgeClosingCostsPercent",e),suffix:"%",tooltip:"Estimated closing costs on bridge purchase."}),t.strategy===s.FLIP?(0,r.jsx)(B,{label:"Flip hold months (post-rehab)",value:F(t.flipHoldMonths),onChange:e=>ei("flipHoldMonths",e)}):null]})]}),(0,r.jsx)("div",{className:L.default.section,children:t.strategy!==s.FLIP?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Long-term financing"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Buy & Hold / BRRRR"})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[(0,r.jsx)(B,{label:"Down payment %",value:F(t.loan.downPaymentPercent),onChange:e=>ei("loan",{...t.loan,downPaymentPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Interest rate % (annual)",value:F(t.loan.interestRateAnnualPercent),onChange:e=>ei("loan",{...t.loan,interestRateAnnualPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Term (years)",value:F(t.loan.termYears),onChange:e=>ei("loan",{...t.loan,termYears:e})}),(0,r.jsx)(B,{label:"Closing costs % of purchase",value:F(t.loan.closingCostsPercent??0),onChange:e=>ei("loan",{...t.loan,closingCostsPercent:e}),suffix:"%",tooltip:"Estimate of lender/title costs at purchase."}),(0,r.jsx)(B,{label:"Lender points %",value:F(t.loan.lenderPointsPercent??0),onChange:e=>ei("loan",{...t.loan,lenderPointsPercent:e}),suffix:"%",tooltip:"Points charged on the long-term loan amount."}),t.strategy===s.BRRRR?(0,r.jsx)(B,{label:"Refinance LTV % (BRRRR)",value:F(t.refinanceLtvPercent),onChange:e=>ei("refinanceLtvPercent",e),suffix:"%"}):null]})]}):(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Long-term financing"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Not used for Flip"})]})}),(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Operating expenses"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Percentages apply to rent by phase"})]}),(0,r.jsxs)("div",{className:L.default.fieldGrid,children:[(0,r.jsx)(B,{label:"Taxes (annual)",value:F(t.operating.taxesAnnual),onChange:e=>ei("operating",{...t.operating,taxesAnnual:e}),prefix:"$"}),(0,r.jsx)(B,{label:"Insurance (annual)",value:F(t.operating.insuranceAnnual),onChange:e=>ei("operating",{...t.operating,insuranceAnnual:e}),prefix:"$"}),(0,r.jsx)(B,{label:"Vacancy %",value:F(t.operating.vacancyPercent),onChange:e=>ei("operating",{...t.operating,vacancyPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Management %",value:F(t.operating.managementPercent),onChange:e=>ei("operating",{...t.operating,managementPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Repairs %",value:F(t.operating.repairsPercent),onChange:e=>ei("operating",{...t.operating,repairsPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Capex %",value:F(t.operating.capexPercent),onChange:e=>ei("operating",{...t.operating,capexPercent:e}),suffix:"%"}),(0,r.jsx)(B,{label:"Other monthly expenses",value:F(t.operating.otherMonthlyExpenses??0),onChange:e=>ei("operating",{...t.operating,otherMonthlyExpenses:e}),prefix:"$"}),(0,r.jsx)(B,{label:"Utilities (monthly)",value:F(t.operating.utilitiesMonthly??0),onChange:e=>ei("operating",{...t.operating,utilitiesMonthly:e}),prefix:"$"})]})]}),t.rehabPlanned&&(0,r.jsxs)("div",{className:L.default.section,children:[(0,r.jsxs)("div",{className:"section-title",children:[(0,r.jsx)("h4",{children:"Rehab estimator"}),(0,r.jsx)("div",{className:"pill-ghost",children:"Rental vs Flip/Premium vs Retail (1.5x)"})]}),(0,r.jsxs)("div",{className:L.default.buttonRow,children:[(0,r.jsx)(O,{label:"Include rehab in cash required",active:t.includeRehabInCashRequired,onClick:()=>ei("includeRehabInCashRequired",!t.includeRehabInCashRequired)}),[c.RENTAL,c.FLIP,c.RETAIL].map(e=>(0,r.jsx)(O,{label:e===c.RENTAL?"Rental Grade":e===c.FLIP?"Flip/Premium":"Retail",active:t.rehabClass===e,onClick:()=>ei("rehabClass",e)},e)),(0,r.jsx)(O,{label:"Use presets",active:!1,onClick:()=>ee("defaults")}),(0,r.jsx)(O,{label:"Clear all",active:!1,onClick:()=>ee("clear")})]}),(0,r.jsxs)("div",{className:"data-row",style:{marginTop:8},children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Rehab total"}),(0,r.jsx)("div",{className:"input-helper",children:"Auto-updates by grade and quantity"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(X.total))})]}),(0,r.jsx)("div",{className:L.default.rehabSection,children:["Flooring","Kitchen","Bathrooms","General","Infrastructure","Contingency"].map(e=>{let a=f.filter(a=>a.category===e);return a.length?(0,r.jsxs)("details",{className:L.default.categoryBlock,open:!0,children:[(0,r.jsxs)("summary",{className:L.default.categoryHeader,children:[(0,r.jsx)("div",{className:L.default.categoryTitle,children:e}),(0,r.jsx)("div",{className:"pill-ghost",children:t.rehabClass})]}),(0,r.jsxs)("table",{className:L.default.miniTable,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Item"}),(0,r.jsx)("th",{children:"Qty"}),(0,r.jsx)("th",{children:"Unit"}),(0,r.jsx)("th",{children:"Total"})]})}),(0,r.jsx)("tbody",{children:a.map(e=>{let a=t.rehabSelections.find(a=>a.itemId===e.id)??{itemId:e.id,quantity:e.defaultQuantity??0,enabled:!1},l=X.lineItems.find(a=>a.item.id===e.id),i=l?.unitPrice??(t.rehabClass===c.RETAIL?g(e,c.RETAIL):g(e,t.rehabClass)),s=a.customUnitPrice??i,o=a.enabled?l?.lineTotal??s*(a.quantity??0):0;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:(0,r.jsxs)("label",{className:"input-label",style:{display:"flex",gap:8,alignItems:"center"},children:[(0,r.jsx)("input",{type:"checkbox",checked:a.enabled??!1,onChange:a=>{var t,r;return t=e.id,r=a.target.checked,void n(e=>({...e,rehabSelections:e.rehabSelections.map(e=>e.itemId===t?{...e,enabled:r}:e)}))}}),e.label]})}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{className:`input ${L.default.input} ${L.default.qtyInput}`,type:"number",min:0,value:F(a.quantity),disabled:!a.enabled,onChange:a=>{var t,r;return t=e.id,r=Math.max(0,parseFloat(a.target.value)||0),void n(e=>({...e,rehabSelections:e.rehabSelections.map(e=>e.itemId===t?{...e,quantity:r,enabled:r>0||e.enabled}:e)}))}})}),(0,r.jsx)("td",{children:(0,r.jsx)("input",{className:`input ${L.default.input} ${L.default.qtyInput}`,type:"number",min:0,value:F(a.customUnitPrice??i),disabled:!a.enabled,onChange:a=>{var t,r;return t=e.id,r=Math.max(0,parseFloat(a.target.value)||0),void n(e=>({...e,rehabSelections:e.rehabSelections.map(e=>e.itemId===t?{...e,customUnitPrice:r,enabled:e.enabled??r>0}:e)}))}})}),(0,r.jsx)("td",{children:z.format(Math.round(o))})]},e.id)})})]})]},e):null})})]})]})}),(0,r.jsxs)("div",{className:L.default.rightColumn,children:[(0,r.jsxs)("div",{className:`${L.default.summaryCard} card`,children:[(0,r.jsxs)("header",{className:L.default.summaryHeader,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:L.default.kicker,children:"Deal summary"}),(0,r.jsxs)("h3",{children:[t.strategy," metrics"]})]}),(0,r.jsxs)("div",{className:"pill-ghost",children:[t.monthsToSimulate," mo horizon"]})]}),t.strategy===s.BUY_HOLD&&(0,r.jsxs)("div",{className:L.default.kpiGrid,children:[(0,r.jsx)(U,{label:"Cash required",value:z.format(Math.round(ea.metrics.cashRequired)),hint:t.includeRehabInCashRequired?"Includes rehab total":"Excludes rehab total"}),(0,r.jsx)(U,{label:"Cumulative cash flow",value:z.format(Math.round(el?.cumulativeCashFlow??0)),hint:"Through selected month horizon."}),(0,r.jsx)(U,{label:"Ending equity",value:z.format(Math.round(el?.equity??0)),hint:"Property value minus loan balance."}),(0,r.jsx)(U,{label:"Total return",value:z.format(Math.round(ea.metrics.totalReturn)),hint:"Equity + cumulative cash flow."}),t.rehabPlanned?(0,r.jsx)(U,{label:"Rehab total",value:z.format(Math.round(X.total)),hint:`Grade: ${t.rehabClass}`}):null]}),t.strategy===s.BRRRR&&(0,r.jsxs)("div",{className:L.default.kpiGrid,children:[(0,r.jsx)(U,{label:"Refi month",value:`Month ${et.refinanceMonth}`,hint:"ARV realized after rehab"}),(0,r.jsx)(U,{label:"Cash required",value:z.format(Math.round(et.metrics.cashRequired)),hint:"Rehab + bridge costs + carry"}),(0,r.jsx)(U,{label:"Bridge interest",value:z.format(Math.round(et.bridgeInterest)),hint:"Accrued until refi"}),(0,r.jsx)(U,{label:"Carry to refi",value:z.format(Math.round(et.carryingCosts)),hint:"Bridge interest + taxes/insurance/other"}),(0,r.jsx)(U,{label:"Cash out at refi",value:z.format(Math.round(et.cashOut)),hint:"Max(Refi - payoff, 0)"}),(0,r.jsx)(U,{label:"COC post-refi",value:`${((et.metrics.coc??0)*100).toFixed(1)}%`,hint:"Cash flow after refi / cash required"}),(0,r.jsx)(U,{label:"DSCR (Y1 post-refi)",value:(et.annual[0]?.dscr??0).toFixed(2),hint:"NOI / debt service"}),t.rehabPlanned?(0,r.jsx)(U,{label:"Rehab total",value:z.format(Math.round(X.total)),hint:`Grade: ${t.rehabClass}`}):null]}),t.strategy===s.FLIP&&(0,r.jsxs)("div",{className:L.default.kpiGrid,children:[(0,r.jsx)(U,{label:"Sale month",value:`Month ${en.saleMonth}`,hint:"Rehab + hold"}),(0,r.jsx)(U,{label:"Sale price",value:z.format(Math.round(en.salePrice)),hint:"Using ARV"}),(0,r.jsx)(U,{label:"Total costs",value:z.format(Math.round(en.totalCosts)),hint:"Purchase + rehab + carrying + selling"}),(0,r.jsx)(U,{label:"Net profit",value:z.format(Math.round(en.netProfit)),hint:"After fees and costs"}),(0,r.jsx)(U,{label:"Profit after tax",value:z.format(Math.round(en.profitAfterTax)),hint:`${t.marginalTaxRatePercent}% marginal rate`}),(0,r.jsx)(U,{label:"ROI",value:`${(100*en.roi).toFixed(1)}%`,hint:"Net / total costs"}),(0,r.jsx)(U,{label:"ROI after tax",value:`${(100*en.roiAfterTax).toFixed(1)}%`,hint:"Profit after tax / total costs"})]}),t.strategy===s.BUY_HOLD&&(0,r.jsxs)("div",{className:L.default.subgrid,children:[(0,r.jsx)("div",{className:"pill-ghost",style:{width:"fit-content"},children:"Cash required breakdown"}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Down payment"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.downPaymentPercent,"% of purchase"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.downPayment))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Closing costs"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.closingCostsPercent??0,"% of purchase"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.closingCosts))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Lender points"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.lenderPointsPercent??0,"% of loan"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.lenderPoints))})]}),t.includeRehabInCashRequired?(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Rehab total"}),(0,r.jsx)("div",{className:"input-helper",children:"Included in cash required"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(X.total))})]}):null]})]}),t.rehabPlanned&&(0,r.jsxs)("div",{className:`${L.default.summaryCard} card`,children:[(0,r.jsxs)("header",{className:L.default.summaryHeader,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:L.default.kicker,children:"Rehab breakdown"}),(0,r.jsxs)("h3",{children:["Line items (",t.rehabClass,")"]})]}),(0,r.jsxs)("div",{className:"pill-ghost",children:["Total: ",z.format(Math.round(X.total))]})]}),(0,r.jsxs)("table",{className:L.default.miniTable,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Item"}),(0,r.jsx)("th",{children:"Qty"}),(0,r.jsx)("th",{children:"Unit"}),(0,r.jsx)("th",{children:"Total"})]})}),(0,r.jsx)("tbody",{children:X.lineItems.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.item.label}),(0,r.jsx)("td",{children:e.quantity}),(0,r.jsx)("td",{children:z.format(Math.round(e.unitPrice))}),(0,r.jsx)("td",{children:z.format(Math.round(e.lineTotal))})]},e.item.id))})]})]}),(0,r.jsxs)("div",{className:`${L.default.summaryCard} card`,children:[(0,r.jsxs)("header",{className:L.default.summaryHeader,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:L.default.kicker,children:"Timeline preview"}),(0,r.jsx)("h3",{children:"Phase boundaries"})]}),(0,r.jsx)("div",{className:"pill-ghost",children:"Spec driven"})]}),(0,r.jsxs)("div",{className:L.default.timelineBar,children:[(0,r.jsxs)("div",{className:`${L.default.timelineSegment} ${L.default.current}`,style:{flex:Math.max(W.tenantMonths||0,.5)},children:[(0,r.jsx)("span",{children:"Current"}),(0,r.jsx)("strong",{children:W.tenantMonths>0?`Month 1-${W.tenantMonths}`:"Skipped"})]}),t.rehabPlanned&&Z?(0,r.jsxs)("div",{className:`${L.default.timelineSegment} ${L.default.rehab}`,style:{flex:Math.max(Z,.5)},children:[(0,r.jsx)("span",{children:"Rehab"}),(0,r.jsxs)("strong",{children:[W.rehabStartMonth,"-",W.rehabEndMonth]})]}):(0,r.jsxs)("div",{className:`${L.default.timelineSegment} ${L.default.rehab} ${L.default.timelineMuted}`,children:[(0,r.jsx)("span",{children:"Rehab"}),(0,r.jsx)("strong",{children:"None"})]}),(0,r.jsxs)("div",{className:`${L.default.timelineSegment} ${L.default.stabilized}`,children:[(0,r.jsx)("span",{children:"Stabilized"}),(0,r.jsxs)("strong",{children:["Month ",W.stabilizedMonth,"+"]})]})]}),(0,r.jsxs)("div",{className:L.default.dataList,children:[(0,r.jsx)(V,{label:"Current phase rent",value:t.isOccupied&&t.modelCurrentVsFuture?z.format(t.currentMonthlyRent||0):"Vacant / $0",helper:t.modelCurrentVsFuture?`Months 1-${Math.max(W.tenantMonths,0)}`:"Legacy: stabilized immediately"}),(0,r.jsx)(V,{label:"Stabilized rent",value:z.format(t.targetMonthlyRent||0),helper:`Begins month ${J.phases.stabilizedMonth}`}),(0,r.jsx)(V,{label:"Rehab period",value:t.rehabPlanned&&J.phases.rehabEndMonth?`Months ${J.phases.rehabStartMonth}-${J.phases.rehabEndMonth} (${J.phases.rehabEndMonth-J.phases.rehabStartMonth+1} mo)`:"None (rent steps from current to target after tenant leaves)",helper:"Rent set to 0 during rehab."}),(0,r.jsx)(V,{label:"Refinance month (BRRRR)",value:J.phases.refinanceMonth?`Month ${J.phases.refinanceMonth} (ARV realized)`:"N/A until rehab is set",helper:t.rehabPlanned?"Refi keyed to ARV after rehab end.":"No rehab: refi anchored to tenant turnover/as-is value."}),(0,r.jsx)(V,{label:"As-is value baseline",value:z.format(t.asIsValue||t.purchasePrice),helper:"Used for pre-rehab appreciation."})]}),(0,r.jsxs)("div",{className:L.default.badges,children:[(0,r.jsx)("div",{className:"chip badge-accent",children:"0 rent during rehab"}),(0,r.jsx)("div",{className:"chip badge-accent",children:"Expenses follow rent phase"}),(0,r.jsx)("div",{className:"chip",children:"Bridge interest accrues during rehab"})]})]}),(0,r.jsxs)("div",{className:`${L.default.resultsCard} card`,children:[(0,r.jsxs)("header",{className:L.default.summaryHeader,children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:L.default.kicker,children:"Results preview"}),(0,r.jsx)("h3",{children:"KPIs & Investment Analysis"})]}),(0,r.jsx)("div",{className:"pill-ghost",children:"Sample values for layout"})]}),(0,r.jsxs)("div",{className:L.default.kpiGrid,children:[(0,r.jsx)(U,{label:"Cash required",value:z.format(Math.round(ea.metrics.cashRequired)),hint:"Down payment + closing + points."}),(0,r.jsx)(U,{label:"Year 1 cash flow",value:z.format(Math.round(ea.annual[0]?.cashFlow??0)),hint:"Includes mortgage + opEx."}),(0,r.jsx)(U,{label:"Stabilized month",value:`Month ${W.stabilizedMonth}`,hint:"Target rent begins here."}),(0,r.jsx)(U,{label:"Refi month (BRRRR)",value:W.refinanceMonth?`Month ${W.refinanceMonth}`:"Pending",hint:t.rehabPlanned?"ARV realized after rehab end.":"No rehab: refi anchored to tenant turnover."}),(0,r.jsx)(U,{label:"Value at refi month",value:function(e,a){if(!e)return"N/A";let t=a.find(a=>a.month===e);return t?z.format(Math.round(t.value)):"N/A"}(W.refinanceMonth||W.stabilizedMonth,ea.monthly.map(e=>({month:e.month,value:e.propertyValue}))),hint:`ARV: ${z.format(t.arv)} • As-is: ${z.format(t.asIsValue||t.purchasePrice)}`}),(0,r.jsx)(U,{label:"DSCR (Year 1)",value:(ea.annual[0]?.dscr??0).toFixed(2),hint:"NOI / debt service."}),(0,r.jsx)(U,{label:"Zero-rent months",value:`${J.zeroMonths} mo`,hint:"Vacancy + rehab months in the window."})]}),(0,r.jsxs)("div",{className:L.default.subgrid,children:[(0,r.jsx)("div",{className:"pill-ghost",style:{width:"fit-content"},children:"Cash required breakdown"}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Down payment"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.downPaymentPercent,"% of purchase"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.downPayment))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Closing costs"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.closingCostsPercent??0,"% of purchase"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.closingCosts))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Lender points"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.loan.lenderPointsPercent??0,"% of loan"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(ea.metrics.cashRequiredBreakdown.lenderPoints))})]})]}),t.strategy===s.BUY_HOLD&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("table",{className:L.default.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Month"}),(0,r.jsx)("th",{children:"Phase"}),(0,r.jsx)("th",{children:"Rent"}),(0,r.jsx)("th",{children:"Cash flow"}),(0,r.jsx)("th",{children:"Property value"}),(0,r.jsx)("th",{children:"Equity"})]})}),(0,r.jsx)("tbody",{children:ea.monthly.map((e,a)=>{var t;let n=J.schedule[a]?.phase??"STABILIZED";return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.month}),(0,r.jsx)("td",{children:"CURRENT"===(t=n)?"Current condition":"REHAB"===t?"Rehab (rent paused)":"Stabilized"}),(0,r.jsx)("td",{children:z.format(Math.round(e.rent))}),(0,r.jsx)("td",{children:z.format(Math.round(e.cashFlow))}),(0,r.jsx)("td",{children:z.format(Math.round(e.propertyValue))}),(0,r.jsx)("td",{children:z.format(Math.round(e.equity))})]},e.month)})})]}),(0,r.jsx)("div",{className:"pill-ghost",style:{marginTop:10,width:"fit-content"},children:"Investment Analysis (annualized)"}),(0,r.jsxs)("table",{className:L.default.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Year"}),(0,r.jsx)("th",{children:"NOI"}),(0,r.jsx)("th",{children:"Cash Flow"}),(0,r.jsx)("th",{children:"Debt Service"}),(0,r.jsx)("th",{children:"Principal Paid"}),(0,r.jsx)("th",{children:"DSCR"})]})}),(0,r.jsx)("tbody",{children:ea.annual.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.year}),(0,r.jsx)("td",{children:z.format(Math.round(e.noi))}),(0,r.jsx)("td",{children:z.format(Math.round(e.cashFlow))}),(0,r.jsx)("td",{children:z.format(Math.round(e.debtService))}),(0,r.jsx)("td",{children:z.format(Math.round(e.principalPaid))}),(0,r.jsx)("td",{children:e.dscr.toFixed(2)})]},e.year))})]})]}),t.strategy===s.BRRRR&&(0,r.jsxs)("table",{className:L.default.table,children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Month"}),(0,r.jsx)("th",{children:"Rent"}),(0,r.jsx)("th",{children:"Cash flow"}),(0,r.jsx)("th",{children:"Property value"}),(0,r.jsx)("th",{children:"Equity"})]})}),(0,r.jsx)("tbody",{children:et.monthly.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.month}),(0,r.jsx)("td",{children:z.format(Math.round(e.rent))}),(0,r.jsx)("td",{children:z.format(Math.round(e.cashFlow))}),(0,r.jsx)("td",{children:z.format(Math.round(e.propertyValue))}),(0,r.jsx)("td",{children:z.format(Math.round(e.equity))})]},e.month))})]}),t.strategy===s.BRRRR&&(0,r.jsxs)("div",{className:L.default.subgrid,children:[(0,r.jsx)("div",{className:"pill-ghost",style:{width:"fit-content"},children:"Refinance summary"}),(0,r.jsxs)("div",{className:L.default.pillRow,children:[(0,r.jsxs)("div",{className:"chip badge-accent",children:["ARV at refi: ",z.format(Math.round(et.valueAtRefi))]}),t.rehabPlanned?null:(0,r.jsxs)("div",{className:"chip badge-accent",children:["No rehab: refi anchored to month ",W.refinanceMonth," (tenant turnover/as-is)"]}),(0,r.jsxs)("div",{className:"chip",children:["Refi amount (",t.refinanceLtvPercent,"% LTV): ",z.format(Math.round(et.refinanceAmount))]}),(0,r.jsxs)("div",{className:"chip",children:["Bridge payoff: ",z.format(Math.round(et.payoffBridge))]}),(0,r.jsxs)("div",{className:"chip",children:["Cash out: ",z.format(Math.round(et.cashOut))]}),(0,r.jsxs)("div",{className:"chip",children:["Carry to refi: ",z.format(Math.round(et.carryingCosts))]})]})]}),t.strategy===s.FLIP&&(0,r.jsxs)("div",{className:L.default.subgrid,children:[(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Sale month"}),(0,r.jsx)("div",{className:"input-helper",children:"Rehab + hold"})]}),(0,r.jsx)("strong",{children:en.saleMonth})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Total costs"}),(0,r.jsx)("div",{className:"input-helper",children:"Purchase + rehab + carrying + selling"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(en.totalCosts))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Net profit"}),(0,r.jsx)("div",{className:"input-helper",children:"After all fees"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(en.netProfit))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Profit after tax"}),(0,r.jsxs)("div",{className:"input-helper",children:[t.marginalTaxRatePercent,"% marginal rate"]})]}),(0,r.jsx)("strong",{children:z.format(Math.round(en.profitAfterTax))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"ROI"}),(0,r.jsx)("div",{className:"input-helper",children:"Net / total costs"})]}),(0,r.jsxs)("strong",{children:[(100*en.roi).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"ROI after tax"}),(0,r.jsx)("div",{className:"input-helper",children:"Profit after tax / total costs"})]}),(0,r.jsxs)("strong",{children:[(100*en.roiAfterTax).toFixed(1),"%"]})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Bridge principal"}),(0,r.jsx)("div",{className:"input-helper",children:"Purchase + rehab"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(er.bridgePrincipal))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Bridge interest"}),(0,r.jsx)("div",{className:"input-helper",children:"Accrued over financed months"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(er.interest))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Carrying"}),(0,r.jsx)("div",{className:"input-helper",children:"Taxes + insurance over financed months"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(er.carrying))})]}),(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:"Selling costs"}),(0,r.jsx)("div",{className:"input-helper",children:"Agent + seller costs"})]}),(0,r.jsx)("strong",{children:z.format(Math.round(er.sellingCosts+er.agentFee))})]})]})]})]})]})]})}function k(){return(0,r.jsx)(l.Suspense,{fallback:(0,r.jsx)("div",{className:"card",style:{padding:20},children:"Loading analyzer..."}),children:(0,r.jsx)(q,{})})}function B({label:e,helper:a,value:t,onChange:n,prefix:l,suffix:i,tooltip:s}){return(0,r.jsxs)("label",{className:"input-group",title:s??a,children:[(0,r.jsx)("div",{className:"input-label",children:e}),(0,r.jsxs)("div",{className:L.default.inputShell,children:[l?(0,r.jsx)("span",{className:L.default.prefix,children:l}):null,(0,r.jsx)("input",{className:`input ${L.default.input}`,type:"number",value:t,onChange:e=>n(parseFloat(e.target.value)||0),min:0}),i?(0,r.jsx)("span",{className:L.default.suffix,children:i}):null]}),a?(0,r.jsx)("div",{className:"input-helper",children:a}):null]})}function O({label:e,active:a,disabled:t,onClick:n}){return(0,r.jsx)("button",{type:"button",className:`${L.default.toggleButton} ${a?L.default.toggleButtonActive:""} ${t?L.default.toggleButtonDisabled:""}`,onClick:()=>{t||n()},"aria-disabled":t,children:e})}function V({label:e,value:a,helper:t}){return(0,r.jsxs)("div",{className:"data-row",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"input-label",children:e}),t?(0,r.jsx)("div",{className:"input-helper",children:t}):null]}),(0,r.jsx)("strong",{children:a})]})}function U({label:e,value:a,hint:t}){return(0,r.jsxs)("div",{className:L.default.kpiCard,children:[(0,r.jsx)("div",{className:L.default.kpiLabel,children:e}),(0,r.jsx)("div",{className:L.default.kpiValue,children:a}),t?(0,r.jsx)("div",{className:L.default.kpiHint,children:t}):null]})}e.s(["default",()=>k],86493)}]);